# Иерархический каталог товаров

## 📋 Описание

Реализована система навигации по каталогу товаров с полной поддержкой иерархии категорий.

## ✨ Возможности

### Бэкенд (Backend)

1. **API для работы с категориями:**
   - `GET /api/catalog/categories/hierarchy` - получение категорий (корневых или дочерних)
     - Параметры:
       - `parent_id` (опционально) - ID родительской категории
       - `shop_code` (опционально) - код магазина
   
   - `GET /api/catalog/categories/:id` - получение категории с breadcrumb
     - Параметры:
       - `shop_code` (обязательно) - код магазина
   
   - `GET /api/catalog/categories/:categoryId/products` - получение товаров категории
     - Параметры:
       - `shop_code` (опционально)
       - `page`, `limit` (пагинация)

### Фронтенд (Frontend)

1. **Компоненты:**
   - `CategoryBreadcrumbs` - навигация по хлебным крошкам
   - `CategoryCard` - карточка категории с индикацией подкатегорий
   - `CatalogHierarchical` - основной компонент каталога

2. **Функционал:**
   - ✅ Отображение корневых категорий при входе
   - ✅ Клик по категории → показ подкатегорий или товаров
   - ✅ Breadcrumbs для навигации назад
   - ✅ Индикация наличия подкатегорий
   - ✅ Счётчик товаров в категории
   - ✅ Плавные анимации переходов
   - ✅ Адаптивный дизайн
   - ✅ Тёмная тема
   - ✅ Пагинация товаров

## 🎯 Как работает навигация

```
1. Пользователь заходит на /catalog
   ↓
2. Показываются корневые категории (level 0)
   Например: "Vape индустрия", "Кальянная Индустрия", "Зажигалки"
   ↓
3. Клик по "Vape индустрия"
   ↓
4. Показываются подкатегории:
   "POD-системы", "Жидкость для POD-систем", и т.д.
   ↓
5. Клик по "Жидкость для POD-систем"
   ↓
6. Показываются подкатегории:
   "Безникотиновые", "Солевые", "Щелочные"
   ↓
7. Клик по "Солевые"
   ↓
8. Показываются еще подкатегории:
   "10 мл", "30 мл"
   ↓
9. Клик по "10 мл"
   ↓
10. Показываются товары этой категории
```

## 📍 Breadcrumbs (хлебные крошки)

Всегда показывают путь:
```
Все категории > Vape индустрия > Жидкость для POD-систем > Солевые > 10 мл
```

Клик по любому элементу → переход на этот уровень.

## 🎨 UI/UX особенности

### Карточки категорий:
- 📁 **Иконка папки** - если есть подкатегории
- 📦 **Иконка пакета** - если только товары
- 🔢 **Счётчик товаров** - показывает количество
- 💙 **Цветной индикатор** - "Есть подкатегории"
- ➡️ **Стрелка справа** - указывает на возможность перехода
- ✨ **Hover эффекты** - масштабирование и тень

### Товары:
- 🖼️ Превью товара
- 💰 Цена
- 📊 Наличие в магазине
- 🛒 Кнопка "В корзину"
- 🎛️ Переключение вида: сетка/список

## 🚀 Примеры использования

### Структура данных

**Категория:**
```typescript
{
  id: "cat_123",
  shop_code: "shop1",
  name: "Жидкости для POD-систем",
  parent_id: "cat_parent",
  level: 1,
  full_path: "Vape индустрия > Жидкости для POD-систем",
  product_count: 45,
  has_subcategories: true,
  sort_order: 0
}
```

**Breadcrumb:**
```typescript
[
  { id: "cat_1", name: "Vape индустрия", level: 0 },
  { id: "cat_2", name: "Жидкости", level: 1 },
  { id: "cat_3", name: "Солевые", level: 2 }
]
```

## 🔧 Настройка

### Backend:

Роуты уже настроены в `/backend/src/routes/catalog.ts`

### Frontend:

1. Роут настроен в `App.tsx`:
   ```tsx
   <Route path="catalog" element={<CatalogHierarchical />} />
   ```

2. Старый каталог доступен по `/catalog-old` (для совместимости)

## 📊 База данных

Используется таблица `catalog_categories`:
- `id` - уникальный ID категории
- `shop_code` - код магазина
- `name` - название
- `parent_id` - ID родителя (NULL для корневых)
- `level` - уровень вложенности (0, 1, 2...)
- `full_path` - полный путь ("Категория1 > Категория2")
- `sort_order` - порядок сортировки

## 🎯 TODO / Улучшения

- [ ] Добавить выбор магазина (сейчас хардкод shop_code)
- [ ] Добавить фильтры товаров (цена, наличие)
- [ ] Добавить поиск внутри категории
- [ ] Добавить сохранение позиции при возврате назад
- [ ] Добавить SEO-оптимизацию (мета-теги, URL)
- [ ] Добавить кэширование категорий
- [ ] Добавить скелетоны вместо спиннера

## 🐛 Известные ограничения

1. **Shop Code**: Сейчас используется хардкод `shop1`. Нужно добавить выбор магазина.
2. **Кэширование**: Категории загружаются каждый раз заново.

## 📝 Примеры категорий в БД

```
Vape индустрия (level 0)
├── POD-системы (level 1)
│   ├── до 30 W (level 2)
│   └── до 200 W (level 2)
├── Жидкость для POD-систем (level 1)
│   ├── Безникотиновые (level 2)
│   ├── Солевые (level 2)
│   │   ├── 10 мл (level 3)
│   │   └── 30 мл (level 3)
│   └── Щелочные (level 2)
└── Электронные сигареты (level 1)
    ├── ДО 10000 ТЯГ (level 2)
    ├── ОТ 10000 ДО 20000 (level 2)
    └── ОТ 20000 (level 2)

Кальянная Индустрия (level 0)
├── Кальянные смеси (level 1)
│   ├── Растительные смеси (level 2)
│   ├── Табачные смеси (level 2)
│   │   ├── До 50 грамм (level 3)
│   │   └── До 250 грамм (level 3)
│   └── Чайные смеси (level 2)
└── Кальяны и аксессуары (level 1)
    └── Аксессуары для кальянов (level 2)
        ├── Колбы (level 3)
        ├── Чаши (level 3)
        └── Щипцы (level 3)
```

## 🎉 Готово!

Система полностью функциональна и готова к использованию!

