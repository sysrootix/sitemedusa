# üì¶ Catalog System Setup Guide

–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã –∫–∞—Ç–∞–ª–æ–≥–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π 1–°.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-api)
- [–§—Ä–æ–Ω—Ç–µ–Ω–¥](#—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥)
- [–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ](#–∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)

---

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö –∏–∑ 1–° –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å 1–° –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
- ‚úÖ –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ (–≤–∫—É—Å—ã, —Ü–≤–µ—Ç–∞ –∏ —Ç.–¥.)
- ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤/–∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
cd backend
./run_catalog_migration.sh
```

–ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞—Å—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã:
- `shop_locations` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞–≥–∞–∑–∏–Ω–∞—Ö
- `catalog_products` - —Ç–æ–≤–∞—Ä—ã —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –º–∞–≥–∞–∑–∏–Ω–∞–º
- `catalog_exclusions` - –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `catalog_sync_log` - –ª–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ/–æ–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª `.env` –≤ –ø–∞–ø–∫–µ `backend`:

```env
# 1C Balance API Configuration
BALANCE_API_USERNAME=–¢–µ—Ä–µ—Ö–∏–Ω–ù–ê
BALANCE_API_PASSWORD=123455123
BALANCE_API_URL=https://cloud.mda-medusa.ru/mda-trade/hs/Api/BalanceData

# Certificate Configuration
BALANCE_API_CERT_PATH=./routes/certs/terehin_n.cloud.mda-medusa.ru.p12
BALANCE_API_CERT_PASSWORD=000000000

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
```

### 3. –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `terehin_n.cloud.mda-medusa.ru.p12` –≤ –ø–∞–ø–∫—É:
```
backend/routes/certs/
```

### 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd backend
npm install node-forge node-cron

cd ../frontend
# –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
cd backend
npm run dev
```

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è cron –∑–∞–¥–∞—á–∞ (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
- ‚úÖ –í—ã–≤–æ–¥–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –∫–æ–Ω—Å–æ–ª—å

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞

```sql
INSERT INTO shop_locations (
    shop_code, 
    shop_name, 
    address, 
    city, 
    phone, 
    working_hours,
    priority_order,
    is_active
) VALUES (
    '13',
    '–ö–∞–ª–∏–Ω–∏–Ω–∞ 10',
    '—É–ª. –ö–∞–ª–∏–Ω–∏–Ω–∞, 10',
    '–ú–æ—Å–∫–≤–∞',
    '+7 (495) 123-45-67',
    '–ü–Ω-–í—Å: 10:00-22:00',
    0,
    TRUE
);
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

–ß–µ—Ä–µ–∑ API (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è):

```bash
curl -X POST http://localhost:55001/api/catalog-shops/exclusions \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "exclusion_type": "product",
    "item_id": "550e8400-e29b-41d4-a716-446655440000",
    "reason": "–¢–æ–≤–∞—Ä —Å–Ω—è—Ç —Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞"
  }'
```

---

## üåê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

### –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤
```http
GET /api/catalog-shops/shops
GET /api/catalog-shops/shops?city=–ú–æ—Å–∫–≤–∞
```

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "data": {
    "shops": [
      {
        "shop_code": "13",
        "shop_name": "–ö–∞–ª–∏–Ω–∏–Ω–∞ 10",
        "address": "—É–ª. –ö–∞–ª–∏–Ω–∏–Ω–∞, 10",
        "city": "–ú–æ—Å–∫–≤–∞",
        "phone": "+7 (495) 123-45-67",
        "working_hours": "–ü–Ω-–í—Å: 10:00-22:00"
      }
    ]
  }
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –º–∞–≥–∞–∑–∏–Ω–∞
```http
GET /api/catalog-shops/shops/{shopCode}/catalog
```

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "data": {
    "shop": {
      "shop_code": "13",
      "shop_name": "–ö–∞–ª–∏–Ω–∏–Ω–∞ 10",
      "address": "—É–ª. –ö–∞–ª–∏–Ω–∏–Ω–∞, 10",
      "city": "–ú–æ—Å–∫–≤–∞"
    },
    "categories": [
      {
        "id": "cat-001",
        "name": "–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã",
        "products": [
          {
            "id": "prod-001",
            "name": "VAPE Pod System",
            "retail_price": 2500.00,
            "quanty": 10,
            "modifications": [
              {
                "id": "mod-001",
                "name": "–ß–µ—Ä–Ω—ã–π",
                "quanty": 5,
                "retail_price": 2500.00
              },
              {
                "id": "mod-002",
                "name": "–ë–µ–ª—ã–π",
                "quanty": 5,
                "retail_price": 2500.00
              }
            ]
          }
        ]
      }
    ],
    "total_products": 150,
    "total_categories": 8
  }
}
```

#### –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
```http
GET /api/catalog-shops/search?q=vape
GET /api/catalog-shops/search?q=vape&shop_code=13&limit=20
```

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "data": {
    "products": [
      {
        "id": "prod-001",
        "name": "VAPE Pod System",
        "category_name": "–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã",
        "shops": [
          {
            "shop_code": "13",
            "shop_name": "–ö–∞–ª–∏–Ω–∏–Ω–∞ 10",
            "quantity": 10,
            "price": 2500.00
          }
        ]
      }
    ],
    "total": 1
  }
}
```

### –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (—Ç—Ä–µ–±—É–µ—Ç—Å—è JWT)

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–∞–≥–∞–∑–∏–Ω–∞
```http
POST /api/catalog-shops/shops/{shopCode}/sync
Authorization: Bearer YOUR_JWT_TOKEN
```

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "message": "Catalog sync started",
  "data": {
    "shop_code": "13",
    "status": "started"
  }
}
```

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
```http
POST /api/catalog-shops/sync-all
Authorization: Bearer YOUR_JWT_TOKEN
```

#### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```http
GET /api/catalog-shops/sync-status
GET /api/catalog-shops/sync-status?shop_code=13&limit=10
Authorization: Bearer YOUR_JWT_TOKEN
```

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "data": {
    "logs": [
      {
        "id": "log-001",
        "shop_code": "13",
        "sync_type": "scheduled",
        "status": "success",
        "products_synced": 150,
        "products_added": 5,
        "products_updated": 140,
        "products_deactivated": 5,
        "duration_ms": 5234,
        "started_at": "2025-01-15T10:00:00Z",
        "completed_at": "2025-01-15T10:00:05Z"
      }
    ]
  }
}
```

---

## üíª –§—Ä–æ–Ω—Ç–µ–Ω–¥

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ React

```tsx
import api from '@/services/api';

// –ü–æ–ª—É—á–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω—ã
const shops = await api.getCatalogShops();

// –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –º–∞–≥–∞–∑–∏–Ω–∞
const catalog = await api.getShopCatalog('13');

// –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
const searchResults = await api.searchCatalogProducts('vape', '13', 20);

// –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
await api.syncShopCatalog('13');
await api.syncAllCatalogs();
```

### –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–∞–ª–æ–≥–∞

–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `frontend/src/pages/Catalog.tsx` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä–æ–µ API.

–ß—Ç–æ–±—ã –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –Ω–æ–≤–æ–µ API –º–∞–≥–∞–∑–∏–Ω–æ–≤, —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `api.getCatalogShops()` –∏ `api.getShopCatalog()`.

---

## ‚è∞ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –∫–∞—Ç–∞–ª–æ–≥–∏:

- **–ß–∞—Å—Ç–æ—Ç–∞**: –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
- **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫**: –ß–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞
- **–¢—Ä–∏–≥–≥–µ—Ä**: Cron –∑–∞–¥–∞—á–∞ –≤ `catalogCronService.ts`

### –õ–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```
‚è∞ Scheduled catalog sync triggered
üîÑ Starting catalog sync for all active shops
üìç Found 3 active shops to sync
üîÑ Starting catalog sync for shop 13
‚úÖ Catalog sync completed for shop –ö–∞–ª–∏–Ω–∏–Ω–∞ 10 in 5234ms
‚úÖ Scheduled sync completed: 3 successful, 0 failed
```

### –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

```bash
# –ß–µ—Ä–µ–∑ API
curl -X POST http://localhost:55001/api/catalog-shops/sync-all \
  -H "Authorization: Bearer YOUR_TOKEN"
```

---

## üîç –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:
   ```bash
   tail -f backend/logs/combined.log
   ```

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞ –º–µ—Å—Ç–µ:
   ```bash
   ls -la backend/routes/certs/
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```bash
   cat backend/.env | grep BALANCE_API
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—É—Å—Ç–æ–π –∫–∞—Ç–∞–ª–æ–≥

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–∞–≥–∞–∑–∏–Ω –∞–∫—Ç–∏–≤–µ–Ω:
   ```sql
   SELECT * FROM shop_locations WHERE is_active = TRUE;
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
   ```sql
   SELECT * FROM catalog_sync_log 
   ORDER BY started_at DESC LIMIT 10;
   ```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä—É—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:
   ```bash
   curl -X POST http://localhost:55001/api/catalog-shops/shops/13/sync \
     -H "Authorization: Bearer YOUR_TOKEN"
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞—Ä–æ–ª—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ (.p12)
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–æ–≤–∞—Ä—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è:
   ```sql
   SELECT * FROM catalog_exclusions WHERE is_active = TRUE;
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–≤–∞—Ä—ã –∞–∫—Ç–∏–≤–Ω—ã:
   ```sql
   SELECT COUNT(*) FROM catalog_products 
   WHERE shop_code = '13' AND is_active = TRUE;
   ```

---

## üìä –ü–æ–ª–µ–∑–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º
```sql
SELECT 
    sl.shop_name,
    COUNT(DISTINCT cp.id) as total_products,
    COUNT(DISTINCT cp.category_name) as total_categories,
    SUM(cp.quanty) as total_quantity
FROM shop_locations sl
LEFT JOIN catalog_products cp ON sl.shop_code = cp.shop_code AND cp.is_active = TRUE
WHERE sl.is_active = TRUE
GROUP BY sl.shop_name
ORDER BY total_products DESC;
```

### –¢–æ–ø —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –Ω–∞–ª–∏—á–∏—é
```sql
SELECT 
    name,
    category_name,
    COUNT(*) as shop_count,
    SUM(quanty) as total_quantity
FROM catalog_products
WHERE is_active = TRUE
GROUP BY name, category_name
HAVING SUM(quanty) > 0
ORDER BY total_quantity DESC
LIMIT 10;
```

### –¢–æ–≤–∞—Ä—ã —Å –Ω–∏–∑–∫–∏–º –æ—Å—Ç–∞—Ç–∫–æ–º
```sql
SELECT 
    cp.name,
    cp.category_name,
    cp.quanty,
    sl.shop_name
FROM catalog_products cp
JOIN shop_locations sl ON cp.shop_code = sl.shop_code
WHERE cp.is_active = TRUE 
  AND cp.quanty > 0 
  AND cp.quanty < 5
ORDER BY cp.quanty ASC;
```

### –ò—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞)
```sql
SELECT 
    shop_code,
    status,
    products_synced,
    products_added,
    products_updated,
    products_deactivated,
    duration_ms,
    started_at,
    error_message
FROM catalog_sync_log
WHERE started_at > NOW() - INTERVAL '24 hours'
ORDER BY started_at DESC;
```

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –º–∞–≥–∞–∑–∏–Ω—ã –≤ `shop_locations`
2. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–µ—Ä–≤—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ API
4. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `backend/logs/`
- –ò–∑—É—á–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `catalog_sync_log`
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É

**–£–¥–∞—á–∏! üöÄ**

