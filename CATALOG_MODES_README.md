# üè™ –ö–∞—Ç–∞–ª–æ–≥ —Å —Ä–µ–∂–∏–º–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å –¥–≤—É–º—è —Ä–µ–∂–∏–º–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:
1. **–û–±—â–∏–π –∫–∞—Ç–∞–ª–æ–≥** - —Ç–æ–≤–∞—Ä—ã —Å–æ –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤, —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ –≤—Å–µ–º —Ñ–∏–ª–∏–∞–ª–∞–º
2. **–ö–∞—Ç–∞–ª–æ–≥ –ø–æ —Ñ–∏–ª–∏–∞–ª—É** - —Ç–æ–≤–∞—Ä—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ —Å —Ç–æ—á–Ω—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üåê –û–±—â–∏–π –∫–∞—Ç–∞–ª–æ–≥ (–í—Å–µ –º–∞–≥–∞–∑–∏–Ω—ã)
- –¢–æ–≤–∞—Ä—ã –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –º–∏–Ω/–º–∞–∫—Å —Ü–µ–Ω—ã –µ—Å–ª–∏ —Ü–µ–Ω—ã —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞–≥–∞–∑–∏–Ω–æ–≤ –≥–¥–µ –µ—Å—Ç—å —Ç–æ–≤–∞—Ä
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫ –ø–æ –≤—Å–µ–º —Ñ–∏–ª–∏–∞–ª–∞–º
- –ö–Ω–æ–ø–∫–∞ "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å" –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞

### üè¨ –ö–∞—Ç–∞–ª–æ–≥ –ø–æ —Ñ–∏–ª–∏–∞–ª—É
- –¢–æ–≤–∞—Ä—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
- –¢–æ—á–Ω–∞—è —Ü–µ–Ω–∞ –∏ –æ—Å—Ç–∞—Ç–æ–∫ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
- –ö–Ω–æ–ø–∫–∞ "–í –∫–æ—Ä–∑–∏–Ω—É" –¥–ª—è –ø–æ–∫—É–ø–∫–∏
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ —Ç–æ–≤–∞—Ä–∞–º –¥–æ—Å—Ç—É–ø–Ω—ã–º –≤ —Ñ–∏–ª–∏–∞–ª–µ

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É **"–í—Å–µ –º–∞–≥–∞–∑–∏–Ω—ã"** –∏–ª–∏ **"–ú–∞–≥–∞–∑–∏–Ω: [–∫–æ–¥]"**

–ü—Ä–∏ –∫–ª–∏–∫–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–∞–Ω–µ–ª—å —Å –≤—ã–±–æ—Ä–æ–º:
- ‚úÖ **–í—Å–µ –º–∞–≥–∞–∑–∏–Ω—ã** - –æ–±—â–∏–π –∫–∞—Ç–∞–ª–æ–≥
- üè™ **–ú–∞–≥–∞–∑–∏–Ω 1** - –∫–∞—Ç–∞–ª–æ–≥ –ø–µ—Ä–≤–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
- üè™ **–ú–∞–≥–∞–∑–∏–Ω 2** - –∫–∞—Ç–∞–ª–æ–≥ –≤—Ç–æ—Ä–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
- –∏ —Ç.–¥.

### 2. –û–±—â–∏–π –∫–∞—Ç–∞–ª–æ–≥ (–í—Å–µ –º–∞–≥–∞–∑–∏–Ω—ã)

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ñ–∏–¥–∫–æ—Å—Ç—å Salt 50–º–≥ 30–º–ª    ‚îÇ
‚îÇ                            ‚îÇ
‚îÇ 450 ‚Äî 550 ‚ÇΩ                ‚îÇ
‚îÇ –î–æ—Å—Ç—É–ø–Ω–æ –≤ 5 –º–∞–≥–∞–∑–∏–Ω–∞—Ö     ‚îÇ
‚îÇ –í—Å–µ–≥–æ –≤ –Ω–∞–ª–∏—á–∏–∏: 48 —à—Ç.    ‚îÇ
‚îÇ                            ‚îÇ
‚îÇ [  –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å  ]          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**API –∑–∞–ø—Ä–æ—Å:**
```
GET /api/catalog/categories/{categoryId}/products?group_by_name=true
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "products": [
    {
      "id": "prod_123",
      "name": "–ñ–∏–¥–∫–æ—Å—Ç—å Salt 50–º–≥ 30–º–ª",
      "min_price": 450,
      "max_price": 550,
      "total_quantity": 48,
      "available_shops_count": 5,
      "shops": [
        {"shop_code": "shop1", "quantity": 10, "price": 450},
        {"shop_code": "shop2", "quantity": 8, "price": 550},
        // ...
      ]
    }
  ],
  "mode": "general"
}
```

### 3. –ö–∞—Ç–∞–ª–æ–≥ –ø–æ —Ñ–∏–ª–∏–∞–ª—É

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ñ–∏–¥–∫–æ—Å—Ç—å Salt 50–º–≥ 30–º–ª    ‚îÇ
‚îÇ                            ‚îÇ
‚îÇ 450 ‚ÇΩ                      ‚îÇ
‚îÇ –í –Ω–∞–ª–∏—á–∏–∏: 10 —à—Ç.          ‚îÇ
‚îÇ                            ‚îÇ
‚îÇ [  –í –∫–æ—Ä–∑–∏–Ω—É  ]            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**API –∑–∞–ø—Ä–æ—Å:**
```
GET /api/catalog/categories/{categoryId}/products?shop_code=shop1
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "products": [
    {
      "id": "prod_123",
      "shop_code": "shop1",
      "name": "–ñ–∏–¥–∫–æ—Å—Ç—å Salt 50–º–≥ 30–º–ª",
      "retail_price": 450,
      "quanty": 10
    }
  ],
  "mode": "shop"
}
```

## üîß API Endpoints

### GET /api/catalog/shops
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "shops": [
      {"shop_code": "shop1", "product_count": 450},
      {"shop_code": "shop2", "product_count": 380}
    ]
  }
}
```

### GET /api/catalog/categories/hierarchy
–ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `parent_id` (–æ–ø—Ü.) - ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `shop_code` (–æ–ø—Ü.) - —Ñ–∏–ª—å—Ç—Ä –ø–æ –º–∞–≥–∞–∑–∏–Ω—É

### GET /api/catalog/categories/:categoryId/products
–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `shop_code` (–æ–ø—Ü.) - –∫–æ–¥ –º–∞–≥–∞–∑–∏–Ω–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- `group_by_name` (boolean) - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–¥–ª—è –æ–±—â–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞)
- `page`, `limit` - –ø–∞–≥–∏–Ω–∞—Ü–∏—è

**–û—Ç–≤–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç:**
- `products` - –º–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤
- `pagination` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- `mode` - —Ä–µ–∂–∏–º ("general" –∏–ª–∏ "shop")

## üé® –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. ShopSelector
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–±–æ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–∞

**–ü—Ä–æ–ø—Å—ã:**
```typescript
interface ShopSelectorProps {
  shops: Shop[];
  selectedShop: string | null;
  onSelectShop: (shopCode: string | null) => void;
  className?: string;
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```tsx
<ShopSelector
  shops={shops}
  selectedShop={selectedShop}
  onSelectShop={handleShopChange}
/>
```

### 2. CatalogHierarchical
–ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ —Å —Ä–µ–∂–∏–º–∞–º–∏

**–°–æ—Å—Ç–æ—è–Ω–∏—è:**
- `selectedShop` - –≤—ã–±—Ä–∞–Ω–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω (null = –≤—Å–µ –º–∞–≥–∞–∑–∏–Ω—ã)
- `catalogMode` - —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ('general' | 'shop')
- `showShopSelector` - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –ø–∞–Ω–µ–ª—å –≤—ã–±–æ—Ä–∞

## üìä –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤

```typescript
const productsData = await api.getProductsByCategoryId(categoryId, {
  page: currentPage,
  limit: 20,
  shop_code: selectedShop || undefined,
  group_by_name: selectedShop === null, // true –µ—Å–ª–∏ –≤—Å–µ –º–∞–≥–∞–∑–∏–Ω—ã
});
```

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã

```typescript
// –û–±—â–∏–π –∫–∞—Ç–∞–ª–æ–≥
if (catalogMode === 'general' && product.shops) {
  if (product.min_price === product.max_price) {
    // –ï–¥–∏–Ω–∞—è —Ü–µ–Ω–∞
    return <>{product.min_price} ‚ÇΩ</>;
  } else {
    // –î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω
    return <>{product.min_price} ‚Äî {product.max_price} ‚ÇΩ</>;
  }
}

// –ö–∞—Ç–∞–ª–æ–≥ –ø–æ —Ñ–∏–ª–∏–∞–ª—É
if (catalogMode === 'shop') {
  return <>{product.retail_price} ‚ÇΩ</>;
}
```

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è

```typescript
// –û–±—â–∏–π –∫–∞—Ç–∞–ª–æ–≥
if (catalogMode === 'general') {
  return <>–í—Å–µ–≥–æ –≤ –Ω–∞–ª–∏—á–∏–∏: {product.total_quantity} —à—Ç.</>;
}

// –ö–∞—Ç–∞–ª–æ–≥ –ø–æ —Ñ–∏–ª–∏–∞–ª—É
if (catalogMode === 'shop') {
  return <>{product.quanty > 0 ? `–í –Ω–∞–ª–∏—á–∏–∏: ${product.quanty} —à—Ç.` : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}</>;
}
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –±—ç–∫–µ–Ω–¥–∞
```bash
cd backend
npm run build
pm2 restart backend
```

### –ó–∞–ø—É—Å–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
```bash
cd frontend
npm run dev
```

## üì± UX –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–∞
- üéØ **–í—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–∞** –≤–≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- üé® **–¶–≤–µ—Ç–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è** –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
- ‚ú® **–ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è** –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏/–∑–∞–∫—Ä—ã—Ç–∏–∏

### –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
- üí∞ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–∞** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
- üìä **–£–º–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ** –æ—Å—Ç–∞—Ç–∫–æ–≤
- üéØ **–†–∞–∑–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è** - "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å" vs "–í –∫–æ—Ä–∑–∏–Ω—É"

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
- üì± –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
- üíª –î–µ—Å–∫—Ç–æ–ø
- üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–∞ –≤ localStorage
- [ ] –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–≤
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω –º–µ–∂–¥—É –º–∞–≥–∞–∑–∏–Ω–∞–º–∏
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞
- [ ] –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ

